8.Write Sql queries (subqueries, aggregate functions, joins) on the created table.
1.	Query for Search for Available Flights:
SELECT
f.flight_id, a.airline_name, r.origin,
 
r.destination, s.date_of_journey, s.departure_time, s.arrival_time,
f.total_seats - COUNT(b.b_id) AS available_seats FROM
flight f INNER JOIN
airline a ON f.airline_id = a.airline_id INNER JOIN
route r ON f.route_id = r.route_id INNER JOIN
schedule s ON f.schedule_id = s.schedule_id LEFT JOIN
booking b ON f.flight_id = b.flight_id WHERE
r.origin = 'Dubai'
AND r.destination = 'Singapore'
AND s.date_of_journey = '2024-04-05' GROUP BY
f.flight_id, a.airline_name, r.origin, r.destination, s.date_of_journey, s.departure_time, s.arrival_time, f.total_seats;


2.	Query toView Booking History:
SELECT
p.p_firstname, p.p_lastname, b.b_id,
 
f.airline_id, r.origin, r.destination, s.date_of_journey, b.payment_status
FROM
passenger p INNER JOIN
booking b ON p.p_id = b.p_id INNER JOIN
flight f ON b.flight_id = f.flight_id INNER JOIN
route r ON f.route_id = r.route_id INNER JOIN
schedule s ON f.schedule_id = s.schedule_id WHERE
p.p_id = 'Passenger_ID';


3.	Query To Cancel a Ticket:
UPDATE
booking SET
payment_status = 'canceled' WHERE
b_id = '3';


4.	Query to Check Flight Cancellation details:
 
SELECT
t.b_id, t.p_id,
p.p_firstname, p.p_lastname, f.airline_id, r.origin, r.destination,
t.cancellation_status, t.reason
FROM
ticket_cancellation t INNER JOIN
passenger p ON t.p_id = p.p_id INNER JOIN
flight f ON t.flight_id = f.flight_id INNER JOIN
route r ON f.route_id = r.route_id WHERE
t.cancellation_status = 'completed';


5.	Query for are the passengers booked on flight 1 from Delta Airlines:
SELECT
p.p_id, p.p_firstname, p.p_lastname, p.age,
 
p.email_address, p.passport, p.address
FROM
passenger p INNER JOIN
booking b ON p.p_id = b.p_id WHERE
b.flight_id = 1
AND b.airline_id = 1; -- Assuming Delta Airlines has airline_id


6.	Query for how many bookings has each passenger made:
SELECT
p.p_id, p.p_firstname, p.p_lastname,
COUNT(b.b_id) AS total_bookings FROM
passenger p LEFT JOIN
booking b ON p.p_id = b.p_id GROUP BY
p.p_id, p.p_firstname, p.p_lastname;


7.	Query for the total revenue generated by each airline:
SELECT
a.airline_id,
 
a.airline_name,
SUM(sp.price) AS total_revenue FROM
airline a INNER JOIN
seat_price sp ON a.airline_id = sp.airline_id GROUP BY
a.airline_id, a.airline_name;


8.	Query for how many flights are scheduled for each day of the week:
SELECT
s.day_of_journey, COUNT(*) AS total_flights
FROM
schedule s GROUP BY
s.day_of_journey;


9.	Query to Retrieve available flights based on origin, destination, and date of                                                travel:
SELECT
f.flight_id, f.airline_id, s.schedule_id, s.date_of_journey, s.departure_time, s.arrival_time,
 
f.total_seats - COUNT(b.b_id) AS available_seats FROM
flight f INNER JOIN
schedule s ON f.schedule_id = s.schedule_id LEFT JOIN
booking b ON f.flight_id = b.flight_id INNER JOIN
route r ON f.route_id = r.route_id WHERE
r.origin = 'New York'
AND r.destination = 'Los Angeles' AND s.date_of_journey = '2024-04-01'
GROUP BY
f.flight_id, f.airline_id, s.schedule_id, s.date_of_journey, s.departure_time, s.arrival_time, f.total_seats
HAVING
available_seats > 0;


10.	Query to retrieve all cancelled flights along with their cancellation reasons
SELECT
f.flight_id, f.airline_id, s.schedule_id, s.date_of_journey, s.departure_time, s.arrival_time, tc.cancellation_status,
 
tc.reason FROM
flight f INNER JOIN
schedule s ON f.schedule_id = s.schedule_id INNER JOIN
ticket_cancellation tc ON f.flight_id = tc.flight_id WHERE
tc.cancellation_status = 'completed';


11.	Query to retrieve the schedule for a specific route
SELECT
s.schedule_id, s.day_of_journey, s.date_of_journey, s.departure_time, s.arrival_time
FROM
schedule s INNER JOIN
route r ON s.route_id = r.route_id WHERE
r.origin = 'Dubai'
AND r.destination = 'Singapore';
